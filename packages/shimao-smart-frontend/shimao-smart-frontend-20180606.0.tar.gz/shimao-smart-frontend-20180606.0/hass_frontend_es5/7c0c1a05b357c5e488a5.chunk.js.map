{"version":3,"sources":["webpack:///./src/panels/map/ha-entity-marker.js","webpack:///./src/panels/map/ha-panel-map.js"],"names":["ha_entity_marker_HaEntityMarker","Object","events_mixin","polymer_element","_createClass","HaEntityMarker","key","value","_this2","this","prototype","__proto__","getPrototypeOf","call","addEventListener","ev","badgeTap","stopPropagation","entityId","fire","html_tag","a","_templateObject","hass","type","String","entityName","entityPicture","customElements","define","leaflet_src_default","Icon","Default","imagePath","ha_panel_map_HaPanelMap","localize_mixin","ha_panel_map_createClass","HaPanelMap","jiedao","tileLayer","attribution","maxZoom","weixing","lukuang","zoomReverse","baseMaps","街道","卫星","overlayMaps","路况","map","_map","$","layers","style","document","createElement","setAttribute","parentNode","appendChild","setView","control","addTo","drawEntities","setTimeout","invalidateSize","fitMap","bounds","_mapItems","length","LatLng","config","core","latitude","longitude","latLngBounds","item","getLatLng","fitBounds","pad","WGS84_to_Other_Coordinate","x_PI","ee","transform","wgLat","wgLon","Coord","outOfChina","dLat","transformLat","dLon","transformLon","radLat","Math","PI","magic","sin","sqrtMagic","sqrt","cos","mgLat","mgLon","z","theta","atan2","bd_lng","lat","lon","x","y","ret","abs","forEach","marker","remove","mapItems","keys","states","entity","title","compute_state_name","attributes","hidden","compute_state_domain","state","icon","passive","iconHTML","divIcon","html","iconSize","className","push","interactive","circle","color","radius","entity_picture","split","part","substr","join","entity_id","gps_accuracy","ha_panel_map_templateObject","observer","narrow","Boolean","showMenu"],"mappings":"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","file":"7c0c1a05b357c5e488a5.chunk.js","sourcesContent":["import '@polymer/iron-image/iron-image.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\nimport { PolymerElement } from '@polymer/polymer/polymer-element.js';\n\nimport EventsMixin from '../../mixins/events-mixin.js';\n\n/*\n * @appliesMixin EventsMixin\n */\nclass HaEntityMarker extends EventsMixin(PolymerElement) {\n  static get template() {\n    return html`\n    <style include=\"iron-positioning\"></style>\n    <style>\n    .marker {\n      vertical-align: top;\n      position: relative;\n      display: block;\n      margin: 0 auto;\n      width: 2.5em;\n      text-align: center;\n      height: 2.5em;\n      line-height: 2.5em;\n      font-size: 1.5em;\n      border-radius: 50%;\n      border: 0.1em solid var(--ha-marker-color, var(--default-primary-color));\n      color: rgb(76, 76, 76);\n      background-color: white;\n    }\n    iron-image {\n      border-radius: 50%;\n    }\n    </style>\n\n    <div class=\"marker\">\n      <template is=\"dom-if\" if=\"[[entityName]]\">[[entityName]]</template>\n      <template is=\"dom-if\" if=\"[[entityPicture]]\">\n        <iron-image sizing=\"cover\" class=\"fit\" src=\"[[entityPicture]]\"></iron-image>\n      </template>\n    </div>\n`;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n      },\n\n      entityId: {\n        type: String,\n        value: '',\n      },\n\n      entityName: {\n        type: String,\n        value: null,\n      },\n\n      entityPicture: {\n        type: String,\n        value: null,\n      }\n    };\n  }\n\n  ready() {\n    super.ready();\n    this.addEventListener('click', ev => this.badgeTap(ev));\n  }\n\n  badgeTap(ev) {\n    ev.stopPropagation();\n    if (this.entityId) {\n      this.fire('hass-more-info', { entityId: this.entityId });\n    }\n  }\n}\n\ncustomElements.define('ha-entity-marker', HaEntityMarker);\n","import '@polymer/app-layout/app-toolbar/app-toolbar.js';\nimport '@polymer/iron-icon/iron-icon.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\nimport { PolymerElement } from '@polymer/polymer/polymer-element.js';\nimport Leaflet from 'leaflet';\n\nimport '../../components/ha-menu-button.js';\n\nimport './ha-entity-marker.js';\n\nimport computeStateDomain from '../../common/entity/compute_state_domain.js';\nimport computeStateName from '../../common/entity/compute_state_name.js';\nimport LocalizeMixin from '../../mixins/localize-mixin.js';\n\nLeaflet.Icon.Default.imagePath = '/static/images/leaflet';\n\n/*\n * @appliesMixin LocalizeMixin\n */\nclass HaPanelMap extends LocalizeMixin(PolymerElement) {\n  static get template() {\n    return html`\n    <style include=\"ha-style\">\n      #map {\n        height: calc(100% - 64px);\n        width: 100%;\n        z-index: 0;\n      }\n    </style>\n\n    <app-toolbar>\n      <ha-menu-button narrow='[[narrow]]' show-menu='[[showMenu]]'></ha-menu-button>\n      <div main-title>[[localize('panel.map')]]</div>\n    </app-toolbar>\n\n    <div id='map'></div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n        observer: 'drawEntities',\n      },\n\n      narrow: {\n        type: Boolean,\n      },\n\n      showMenu: {\n        type: Boolean,\n        value: false,\n      },\n    };\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    var jiedao = Leaflet.tileLayer(\"http://webrd02.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}\", {\n      attribution: '© <a href=\"http://map.amap.com/doc/serviceitem.html\">高德地图</a> contributors, © <a href=\"http://lbs.amap.com/\">高德软件</a>',\n      maxZoom: 18,\n    });\n    var weixing = Leaflet.tileLayer(\"http://webst04.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}\", {\n      attribution: '© <a href=\"http://map.amap.com/doc/serviceitem.html\">高德地图</a> contributors, © <a href=\"http://lbs.amap.com/\">高德软件</a>',\n      maxZoom: 18,\n    });\n    var lukuang = Leaflet.tileLayer(\"http://tm.amap.com/trafficengine/mapabc/traffictile?v=1.0&;t=1&zoom={z}&x={x}&y={y}\", {\n      maxZoom: 17,\n      zoomReverse: true\n    });\n    var baseMaps = {\n      \"街道\": jiedao,\n      \"卫星\": weixing,\n    };\n    var overlayMaps = {\n      \"路况\": lukuang,\n    };\n\n    var map = this._map = Leaflet.map(this.$.map, {\n      layers: [jiedao,lukuang],\n    });\n\n    var style = document.createElement('link');\n    style.setAttribute('href', '/static/images/leaflet/leaflet.css');\n    style.setAttribute('rel', 'stylesheet');\n    this.$.map.parentNode.appendChild(style);\n    map.setView([51.505, -0.09], 13);\n    Leaflet.control.layers(baseMaps,overlayMaps).addTo(map);\n\n    this.drawEntities(this.hass);\n\n    setTimeout(() => {\n      map.invalidateSize();\n      this.fitMap();\n    }, 1);\n  }\n\n  fitMap() {\n    var bounds;\n\n    if (this._mapItems.length === 0) {\n      this._map.setView(\n        new Leaflet.LatLng(this.hass.config.core.latitude, this.hass.config.core.longitude),\n        14\n      );\n    } else {\n      bounds = new Leaflet.latLngBounds(this._mapItems.map(item => item.getLatLng()));\n      this._map.fitBounds(bounds.pad(0.5));\n    }\n  }\n\n  drawEntities(hass) {\n    /* eslint-disable vars-on-top */\n    /* WGS Coordinate transfer */\n    var WGS84_to_Other_Coordinate = function() {}\n    WGS84_to_Other_Coordinate.prototype.x_PI = 3.14159265358979324 * 3000.0 / 180.0;\n    WGS84_to_Other_Coordinate.prototype.a = 6378245.0;\n    WGS84_to_Other_Coordinate.prototype.ee = 0.00669342162296594323;\n    WGS84_to_Other_Coordinate.prototype.transform = function(wgLat,wgLon,Coord) {\n      if (this.outOfChina(wgLat, wgLon)) {\n        return [wgLat, wgLon];\n      }\n      dLat = this.transformLat(wgLon - 105.0, wgLat - 35.0);\n      dLon = this.transformLon(wgLon - 105.0, wgLat - 35.0);\n      radLat = wgLat / 180.0 * Math.PI;\n      magic = Math.sin(radLat);\n      magic = 1 - this.ee * magic * magic;\n      sqrtMagic = Math.sqrt(magic);\n      dLat = (dLat * 180.0) / ((this.a * (1 - this.ee)) / (magic * sqrtMagic) * Math.PI);\n      dLon = (dLon * 180.0) / (this.a / sqrtMagic * Math.cos(radLat) * Math.PI);\n      mgLat = wgLat + dLat;\n      mgLon = wgLon + dLon;\n      if (Coord){\n        return [mgLat, mgLon];\n      } else {\n        var z = Math.sqrt(mgLon * mgLon + mgLat * mgLat) + 0.00002 * Math.sin(mgLat * this.x_PI);\n        var theta = Math.atan2(mgLat, mgLon) + 0.000003 * Math.cos(mgLon * this.x_PI);\n        var bd_lng = z * Math.cos(theta) + 0.0065;\n        var bd_lat = z * Math.sin(theta) + 0.006;\n        return [bd_lat,bd_lng]\n      }\n    };\n    WGS84_to_Other_Coordinate.prototype.outOfChina = function(lat, lon) {\n      if (lon < 72.004 || lon > 137.8347)\n        return true;\n      if (lat < 0.8293 || lat > 55.8271)\n        return true;\n      return false;\n    };\n    WGS84_to_Other_Coordinate.prototype.transformLat = function(x, y) {\n      var ret = -100.0 + 2.0 * x + 3.0 * y + 0.2 * y * y + 0.1 * x * y + 0.2 * Math.sqrt(Math.abs(x));\n      ret += (20.0 * Math.sin(6.0 * x * Math.PI) + 20.0 * Math.sin(2.0 * x * Math.PI)) * 2.0 / 3.0;\n      ret += (20.0 * Math.sin(y * Math.PI) + 40.0 * Math.sin(y / 3.0 * Math.PI)) * 2.0 / 3.0;\n      ret += (160.0 * Math.sin(y / 12.0 * Math.PI) + 320 * Math.sin(y * Math.PI / 30.0)) * 2.0 / 3.0;\n      return ret;\n    };\n    WGS84_to_Other_Coordinate.prototype.transformLon = function(x, y) {\n      var ret = 300.0 + x + 2.0 * y + 0.1 * x * x + 0.1 * x * y + 0.1 * Math.sqrt(Math.abs(x));\n      ret += (20.0 * Math.sin(6.0 * x * Math.PI) + 20.0 * Math.sin(2.0 * x * Math.PI)) * 2.0 / 3.0;\n      ret += (20.0 * Math.sin(x * Math.PI) + 40.0 * Math.sin(x / 3.0 * Math.PI)) * 2.0 / 3.0;\n      ret += (150.0 * Math.sin(x / 12.0 * Math.PI) + 300.0 * Math.sin(x / 30.0 * Math.PI)) * 2.0 / 3.0;\n      return ret;\n    };\n\n    var map = this._map;\n    if (!map) return;\n\n    if (this._mapItems) {\n      this._mapItems.forEach(function (marker) { marker.remove(); });\n    }\n    var mapItems = this._mapItems = [];\n\n    Object.keys(hass.states).forEach(function (entityId) {\n      var entity = hass.states[entityId];\n      var title = computeStateName(entity);\n\n      if ((entity.attributes.hidden &&\n          computeStateDomain(entity) !== 'zone') ||\n          entity.state === 'home' ||\n          !('latitude' in entity.attributes) ||\n          !('longitude' in entity.attributes)) {\n        return;\n      }\n\n      var icon;\n\n      if (computeStateDomain(entity) === 'zone') {\n        // DRAW ZONE\n        if (entity.attributes.passive) return;\n\n        // create icon\n        var iconHTML = '';\n        if (entity.attributes.icon) {\n          iconHTML = (\n            \"<iron-icon icon='\" + entity.attributes.icon + \"'></iron-icon>\");\n        } else {\n          iconHTML = title;\n        }\n\n        icon = Leaflet.divIcon({\n          html: iconHTML,\n          iconSize: [24, 24],\n          className: '',\n        });\n\n        // create market with the icon\n        mapItems.push(Leaflet.marker(\n          new WGS84_to_Other_Coordinate().transform(entity.attributes.latitude, entity.attributes.longitude,false),\n          {\n            icon: icon,\n            interactive: false,\n            title: title,\n          }\n        ).addTo(map));\n\n        // create circle around it\n        mapItems.push(Leaflet.circle(\n          new WGS84_to_Other_Coordinate().transform(entity.attributes.latitude, entity.attributes.longitude,false),\n          {\n            interactive: false,\n            color: '#FF9800',\n            radius: entity.attributes.radius,\n          }\n        ).addTo(map));\n\n        return;\n      }\n\n      // DRAW ENTITY\n      // create icon\n      var entityPicture = entity.attributes.entity_picture || '';\n      var entityName = title.split(' ').map(function (part) { return part.substr(0, 1); }).join('');\n      /* Leaflet clones this element before adding it to the map. This messes up\n         our Polymer object and we can't pass data through. Thus we hack like this. */\n      icon = Leaflet.divIcon({\n        html: \"<ha-entity-marker entity-id='\" + entity.entity_id + \"' entity-name='\" + entityName + \"' entity-picture='\" + entityPicture + \"'></ha-entity-marker>\",\n        iconSize: [45, 45],\n        className: '',\n      });\n\n      // create market with the icon\n      mapItems.push(Leaflet.marker(\n        new WGS84_to_Other_Coordinate().transform(entity.attributes.latitude, entity.attributes.longitude,false),\n        {\n          icon: icon,\n          title: computeStateName(entity),\n        }\n      ).addTo(map));\n\n      // create circle around if entity has accuracy\n      if (entity.attributes.gps_accuracy) {\n        mapItems.push(Leaflet.circle(\n          new WGS84_to_Other_Coordinate().transform(entity.attributes.latitude, entity.attributes.longitude,false),\n          {\n            interactive: false,\n            color: '#0288D1',\n            radius: entity.attributes.gps_accuracy,\n          }\n        ).addTo(map));\n      }\n    });\n  }\n}\n\ncustomElements.define('ha-panel-map', HaPanelMap);\n"],"sourceRoot":""}