
<html><head></head><body><h1 id="how-to-release">How to release</h1>
<hr />
<p>Below you can find the release procedure as a checklist. On each release it can be updated (if needed), copied and pasted into a GitHub issue, of course changing the release name.
Then you can check each entry on the GitHub issue when done until the release is end.</p>
<h2 id="changelog-generation">Changelog generation</h2>
<p>To generate the changelog for a specific release you can use <a href="https://github.com/skywinder/github-changelog-generator">github_changelog_generator</a><br>The tool will overwrite the CHANGELOG.md file.</p>
<p><strong>Install (Ubuntu)</strong></p>
<pre><code>sudo apt-get install ruby-dev
sudo gem install rake
sudo gem install github_changelog_generator
</code></pre><p><strong>Configure</strong></p>
<ul>
<li><a href="https://github.com/settings/tokens/new?description=GitHub%20Changelog%20Generator%20token">Generate a github token</a> and place it in your .bashrc this:<pre><code>export CHANGELOG_GITHUB_TOKEN="«your-40-digit-github-token»"
</code></pre>as an alternative use --token</li>
</ul>
<ul>
<li>cd to MapStore2</li>
<li>edit <code>.github_changelog_generator</code> file :<ul>
<li>set <code>since-tag</code> (the first tag you want to exclude)</li>
<li>if you are creating the changelog before creating the tag set <code>future-release</code>=YYYY.NN.mm with the "release branch name" (the tag still needs to be generated)</li>
</ul>
</li>
</ul>
<p>For example the <code>.github_changelog_generator</code> file for the changes between 2017.02.00 and 2017.03.00 release can look like the following (<strong>notice the initial 'v' for the tag</strong>):</p>
<pre><code>future-release=2017.03.00
since-tag=v2017.01.00
</code></pre><p><strong>Run</strong></p>
<p>Github REST API has some usage limits that don't allow to generate the full changelog for a big project like MapStore 2.</p>
<p>To update the changelog you should generate only the latest changes (from the previews release) and add it to the existing change-log. This is more or less the procedure:
 -specify the since-tag with the previous tag (e.g. <code>v2017.05.00</code>, notice the <code>v</code>) and the future-release name (e.g. <code>2015-06-00</code>).</p>
<ul>
<li>backup CHANGELOG.md</li>
<li>run the changelog generator with: <code>github_changelog_generator --max-issues 1000</code> (<strong>notice max-issues flag needed for large repositories</strong>)</li>
<li>Merge the old CHANGELOG.md with the new, appending the new on top.</li>
</ul>
<h2 id="release-checklist">Release Checklist</h2>
<ul class="docma task-list">
<li class="docma task-item"><input type="checkbox" disabled=""> &nbsp;Create an issue with this checklist in the release milestone.</li>
<li class="docma task-item"><input type="checkbox" disabled=""> &nbsp;Create a branch (<strong>YYYY.XX.mm</strong>)  </li>
<li class="docma task-item"><input type="checkbox" disabled=""> &nbsp;Change <a href="http://build.geo-solutions.it/jenkins/view/MapStore2/job/MapStore2-QA-Build/">QA Jenkins job</a> to build the new branch, enable the job continuous deploy</li>
<li class="docma task-item"><input type="checkbox" disabled=""> &nbsp;Test on QA <a href="http://qa.mapstore2.geo-solutions.it/mapstore/">http://qa.mapstore2.geo-solutions.it/mapstore/</a>  <ul>
<li>Any fix must be done on <strong>YYYY.XX.mm</strong>. The fixes will be manually merged on master</li>
<li>Test <strong>everything</strong>, not only the new features</li>
</ul>
</li>
<li class="docma task-item"><input type="checkbox" disabled=""> &nbsp;Generate the changelog with github_changelog_generator. <a href="https://dev.mapstore2.geo-solutions.it/mapstore/docs/release">Instructions</a></li>
<li class="docma task-item"><input type="checkbox" disabled=""> &nbsp;Commit the changelog to the release branch</li>
<li class="docma task-item"><input type="checkbox" disabled=""> &nbsp;Create a <a href="https://github.com/geosolutions-it/MapStore2/releases">github draft release</a> pointing to the branch <strong>YYYY.XX.mm</strong>.  <blockquote>
<p>The Release name should follow be named YYYY.XX.mm where YYYY is the year, XX is the incremental number of the release for the current year (starting from 01) and the second number mm is an incremental value (starting from 00) to increment for minor releases. Insert the tag vYYYY.XX.mm (<strong>notice the initial 'v' for the tag</strong>) to create when the release is published. In the release description describe the major changes and link the Changelog paragraph.</p>
</blockquote>
</li>
<li class="docma task-item"><input type="checkbox" disabled=""> &nbsp;Launch <a href="http://build.geo-solutions.it/jenkins/job/MapStore2-Releaser/">MapStore2-Releaser</a> Jenkins job setting up the correct name of the version (<strong>and wait the end</strong>). <strong>Note:</strong> Using the MapStore2 Releaser allows to write the correct version number into the binary packages.</li>
<li class="docma task-item"><input type="checkbox" disabled=""> &nbsp;Get the <a href="http://build.geo-solutions.it/jenkins/view/MapStore2/job/MapStore2-Releaser/ws/web/target/mapstore.war">latest mapstore.war</a> from the Releaser Jenkins build and upload it to github  </li>
<li class="docma task-item"><input type="checkbox" disabled=""> &nbsp;Get the <a href="http://build.geo-solutions.it/jenkins/view/MapStore2/job/MapStore2-Releaser/ws/release/target/">latest mapstore2-YYYY.XX.mm-bin.zip</a> from the Releaser Jenkins build and upload it to github<blockquote>
<p>from the job <a href="http://build.geo-solutions.it/jenkins/view/MapStore2/job/MapStore2-Releaser/ws/">configuration page</a> there is a link to access the job workspace to easily download the built WAR and binary package</p>
</blockquote>
</li>
<li class="docma task-item"><input type="checkbox" disabled=""> &nbsp;Publish the release</li>
<li class="docma task-item"><input type="checkbox" disabled=""> &nbsp;Merge release branch into master - <em>note: You can do a pull request for this but</em> <em>*do not squash commits</em></li>
<li class="docma task-item"><input type="checkbox" disabled=""> &nbsp;Create a blog post</li>
<li class="docma task-item"><input type="checkbox" disabled=""> &nbsp;Write to the mailing list about the current release news and the next release major changes</li>
<li class="docma task-item"><input type="checkbox" disabled=""> &nbsp;Update the release procedure if needed.</li>
<li class="docma task-item"><input type="checkbox" disabled=""> &nbsp;Close this issue</li>
<li class="docma task-item"><input type="checkbox" disabled=""> &nbsp;Close the related milestone</li>
</ul>
</body></html>