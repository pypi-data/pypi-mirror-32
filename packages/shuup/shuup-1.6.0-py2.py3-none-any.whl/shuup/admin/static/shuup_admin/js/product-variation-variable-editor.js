"use strict";window.VariationVariableEditor=function(e,t){function n(){this.showIdentifierFields=e.prop(!1)}function a(e){o(),d()}function i(){document.getElementById("id_variables-data").value=JSON.stringify(p)}function r(){return"$"+Math.random()}function l(n,a,r){var l=arguments.length<=3||void 0===arguments[3]?"$":arguments[3],o=arguments.length<=4||void 0===arguments[4]||arguments[4],d=e.withAttr("value",function(e){a.identifier=e,i()}),u=function(e,t){a[r][e]=t,i()};return[t.map(h,function(i){var o=i.name,d=i.code,c=e.withAttr("value",t.partial(u,d)),f=l.replace("$",o);return e(n,[f&&f.length?e("label",f):null,e("input.form-control",{value:a[r][d]||"",placeholder:f,oninput:c,onchange:c})])}),o?e(n,[e("input.form-control",{value:a.identifier,placeholder:gettext("Identifier"),oninput:d,onchange:d})]):null]}function o(){var e=document.getElementById("product-variable-wrap");document.getElementsByClassName("variable-sort-handle").length>0&&Sortable.create(e,{group:"variable-sort",handle:".variable-sort-handle",onEnd:function(e){p.reindex(e.oldIndex,e.newIndex),i()}})}function d(e){var t=document.getElementsByClassName("product-variable-values"),e=0;[].forEach.call(t,function(t){Sortable.create(t,{group:"value-sort-"+e,handle:".value-sort-handle",onEnd:function(e){for(var t=e.item.getAttribute("data-id"),n=e.newIndex,a=null,r=null,l=0;l<p.length;l++){a=p[l];for(var o=0;o<a.values.length;o++)r=a.values[o],r.pk==t&&p[l].values.reindex(o,n)}i()}}),e+=1})}function u(t){return e("i.fa.fa-bars."+t+".pull-left","")}function c(t,n,a){var r=t.showIdentifierFields(),o=interpolate(gettext("Value %s Name"),[a+1]);return e("tr",{"data-id":n.pk},e("th",[u("value-sort-handle"),o]),l("td",n,"texts","",r),e("td",e("a.btn.text-danger.btn-xs",{href:"#",onclick:function(){return n.DELETE=!0,i(),!1}},e("i.fa.fa-times-circle")," "+gettext("Delete value"))))}function f(n,a){var o=n.showIdentifierFields(),d=e("a.btn.btn-xs.text-danger",{href:"#",onclick:function(){if(0===a.values.length||confirm(gettext("Are you sure?")))return a.DELETE=!0,i(),!1}},e("i.fa.fa-times-circle")," "+gettext("Delete Variable")),f=e("a.btn.btn-xs.btn-text",{href:"#",onclick:function(e){a.values.push({pk:r(),identifier:"",texts:{}}),e.preventDefault()}},e("i.fa.fa-plus")," "+gettext("Add new value")),s=e("tr",[e("th",gettext("Variable Name"))].concat(l("td",a,"names","",o)).concat([e("td")])),v=t.map(t.reject(a.values,"DELETE"),t.partial(c,n));return e("div.product-variable",{key:a.pk},[e("div.variable-heading.clearfix",[u("variable-sort-handle"),e("h3.pull-left",gettext("Variable")),e("div.pull-right",d)]),e("div.variable-body",[e("div.table-responsive",[e("table.table.table-bordered",[e("thead",[e("tr",[e("th")].concat(t.map(h,function(t){var n=t.name;return e("th",n)})).concat([o?e("th",[gettext("Identifer")]):null,e("th")]))]),e("tbody.product-variable-name",s),e("tbody.product-variable-values",v)])]),e("div.new-row",f)])])}function s(n){var i=e("div.product-variable-wrap",{id:"product-variable-wrap"},t.map(t.reject(p,"DELETE"),t.partial(f,n))),l=e("p",[e("label.small",[e("input",{type:"checkbox",checked:!!n.showIdentifierFields(),onclick:e.withAttr("checked",n.showIdentifierFields)})," "+gettext("Show identifier fields (for advanced users)")])]);return p.length||(i=e("p.text-info",[e("i.fa.fa-exclamation-circle")," "+gettext("There are no variables defined."),e("hr")]),l=null),e("div",{config:a},[l,e("hr"),i,e("a.btn.btn-lg.btn-text",{href:"#",onclick:function(e){p.push({pk:r(),identifier:"",names:{},values:[]}),e.preventDefault()}},e("i.fa.fa-plus")," "+gettext("Add new variable"))])}function v(t){b||(h=t.languages,p=t.variables,window.VariationVariableEditor.ctrl=b=e.mount(document.getElementById("variation-variable-editor"),{controller:n,view:s}))}var h=null,p=null,b=null;return Array.prototype.reindex||(Array.prototype.reindex=function(e,t){this.splice(t,0,this.splice(e,1)[0])}),{init:v}}(window.m,window._);
//# sourceMappingURL=product-variation-variable-editor.js.map
