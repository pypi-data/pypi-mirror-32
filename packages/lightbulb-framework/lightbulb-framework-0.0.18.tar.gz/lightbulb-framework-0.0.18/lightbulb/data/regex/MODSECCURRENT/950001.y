s [ ]
w [a-z0-9A-Z]
W [^a-z0-9A-Z]
d [0-9]
%%
((((s(t(d(dev(\_pop|\_samp)?)?|r(\_to\_date|cmp))|u(b(str(ing(\_index)?)?|(dat|tim)e)|m)|e(c(\_to\_time|ond)|ssion\_user)|ys(tem\_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(s(null|\_(free\_lock|ipv4\_compat|ipv4\_mapped|ipv4|ipv6|not\_null|not|null|used\_lock))?|n(et6?\_(aton|ntoa)|s(ert|tr)|terval)?|f(null)?)|u(n(compress(ed\_length)?|ix\_timestamp|hex)|tc\_(date|time|timestamp)|p(datexml|per)|uid(\_short)?|case|ser)|l(o(ca(l(timestamp)?|te)|g(2|10)?|ad\_file|wer)|ast(\_day|\_insert\_id)?|e((as|f)t|ngth)|case|trim|pad|n)|t(ime(stamp|stampadd|stampdiff|diff|\_format|\_to\_sec)?|o\_(base64|days|seconds|n?char)|r(uncate|im)|an)|m(a(ke(\_set|date)|ster\_pos\_wait|x)|i((crosecon)?d|n(ute)?)|o(nth(name)?|d)|d5)|r(e(p(lace|eat)|lease\_lock|verse)|o(w\_count|und)|a(dians|nd)|ight|trim|pad)|f(i(eld(\_in\_set)?|nd\_in\_set)|rom\_(base64|days|unixtime)|o(und\_rows|rmat)|loor)|a(es\_(de|en)crypt|s(cii(str)?|in)|dd(dat|tim)e|(co|b)s|tan2?|vg)|p(o(sition|w(er)?)|eriod\_(add|diff)|rocedure\_analyse|assword|i)|b(i(t\_(length|count|x?or|and)|n(\_to\_num)?)|enchmark)|e(x(p(ort\_set)?|tract(value)?)|nc(rypt|ode)|lt)|v(a(r(\_(sam|po)p|iance)|lues)|ersion)|g(r(oup\_conca|eates)t|et\_(format|lock))|o((ld\_passwo)?rd|ct(et\_length)?)|we(ek(day|ofyear)?|ight\_string)|n(o(t\_in|w)|ame\_const|ullif)|(rawton?)?hex(toraw)?|qu(arter|ote)|(pg\_)?sleep|year(week)?|d?count|xmltype|hour){W}*\(|((s(elect(.*((length|count|top).*from|from.*where)|.*(d(ump.*from|ata\_type)|(to\_(numbe|cha)|inst)r))|p\_(sqlexec|sp\_replwritetovarbin|sp\_help|addextendedproc|is\_srvrolemember|prepare|sp\_password|execute(sql)?|makewebtask|oacreate)|ql\_(longvarchar|variant))|xp\_(reg(re(movemultistring|ad)|delete(value|key)|enum(value|key)s|addmultistring|write)|terminate|xp\_servicecontrol|xp\_ntsec\_enumdomains|xp\_terminate\_process|e(xecresultset|numdsn)|availablemedia|loginconfig|cmdshell|filelist|dirtree|makecab|ntsec)|u(nion.*select|tl\_(file|http))|d(b(a\_users|ms\_java)|elete{W}*from)|group.*by.*having|open(rowset|owa\_util|query)|load{W}*data.*infile|(n?varcha|tbcreato)r|autonomous\_transaction)|i(n(to{W}*(dump|out)file|sert{W}*into|ner{W}*join)|(f({W}*\({W}*benchmark|null)|snull){W}*\()|print{W}*\@\@|cast{W}*\()|c((ur(rent\_(time(stamp)?|date|user)|(dat|tim)e)|h(ar((acter)?\_length|set)?|r)|iel(ing)?|ast|r32){W}*\(|o((n(v(ert(\_tz)?)?|cat(\_ws)?|nection\_id)|(mpres)?s|ercibility|alesce|t){W}*\(|llation{W}*\(a))|d((a(t(e((\_(add|format|sub))?|diff)|abase)|y(name|ofmonth|ofweek|ofyear)?)|e((s\_(de|en)cryp|faul)t|grees|code)|ump){W}*\(|bms\_{w}+\.)|(\;{W}*(shutdown|drop)|\@\@version)|utl\_inaddr|sys\_context|\'(s(qloledb|a)|msdasql|dbo)\'))) printf('attack detected');
%%
