s [ ]
w [a-z0-9A-Z]
W [^a-z0-9A-Z]
d [0-9]
%%
((\={s}*[$a-zA-Z]{s}*[\(\[])|(\({s}*(this|top|window|self|parent|\_?content){s}*\))|(src{s}*\=s*({w}+\:|\/\/))|({w}+\[(\"{w}+\"|{w}+\|\|))|([0-9\!\@\#\$\%\^\&\*\(\)\-\_\+\=\{\}\[\]\;\:\|\?\/\.\>\,\<\`\~]\|\|[0-9\!\@\#\$\%\^\&\*\(\)\-\_\+\=\{\}\[\]\;\:\|\?\/\.\>\,\<\`\~]|{W}\={w}+,)|(\/{s}*\+{s}*[a\-z\"])|(\={s}*\$[^([]*\()|(\={s}*\({s}*\")) printf('attack detected');
%%
