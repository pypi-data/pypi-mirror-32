"""
API 5L

Add dictionary of API pipe sizes
"""

sizes = {406.4: [4.8, 5.2, 5.6, 6.4, 7.1, 7.9, 8.7, 9.5, 10.3, 11.1, 11.9,
                 12.7, 14.3, 15.9, 17.5, 19.1, 20.6, 22.2, 23.8, 25.4, 27,
                 28.6, 30.2, 31.8],
         457: [4.8, 5.6, 6.4, 7.1, 7.9, 8.7, 9.5, 10.3, 11.1, 11.9, 12.7,
               14.3, 15.9, 17.5, 19.1, 20.6, 22.2, 23.8, 25.4, 27, 28.6,
               30.2, 31.8],
         219.1: [3.2, 4, 4.8, 5.2, 5.6, 6.4, 7, 7.9, 8.2, 8.7, 9.5, 11.1,
                 12.7, 14.3, 15.9, 18.3, 19.1, 20.6, 22.2, 25.4],
         141.3: [2.1, 3.2, 4, 4.8, 5.6, 6.6, 7.1, 7.9, 8.7, 9.5, 12.7,
                 15.9, 19.1],
         168.3: [2.1, 2.8, 3.2, 3.6, 4, 4.4, 4.8, 5.2, 5.6, 6.4, 7.1, 7.9,
                 8.7, 9.5, 11.1, 12.7, 14.3, 15.9, 18.3, 19.1, 22.2],
         273.1: [4, 4.8, 5.2, 5.6, 6.4, 7.1, 7.9, 8.7, 9.3, 11.1, 12.7,
                 14.3, 15.9, 18.3, 20.6, 22.2, 23.8, 25.4, 31.8],
         33.4: [3.4, 4.5, 9.1],
         114.3: [2.1, 3.2, 3.6, 4, 4.4, 4.8, 5.2, 5.6, 6, 6.4, 7.1, 7.9, 8.6,
                 11.1, 13.5, 17.1],
         88.9: [2.1, 2.8, 3.2, 3.6, 3.9, 4.4, 4.8, 5.5, 6.4, 7.1, 7.6, 15.2],
         559: [5.6, 6.4, 7.1, 7.9, 8.7, 9.5, 10.3, 11.1, 11.9, 12.7, 14.3,
               15.9, 17.5, 19.1, 20.6, 22.2, 23.8, 25.4, 27, 28.6, 30.2, 31.8,
               33.3, 34.9, 36.5, 38.1],
         610: [6.4, 7.1, 7.9, 8.7, 9.5, 10.3, 11.1, 11.9, 12.7, 14.3, 15.9,
               17.5, 19.1, 20.6, 22.2, 23.8, 25.4, 27, 28.6, 30.2, 31.8, 33.3,
               34.9, 36.5, 38.1, 39.7],
         323.9: [4.4, 4.8, 5.2, 5.6, 6.4, 7.1, 7.9, 8.4, 8.7, 9.5, 10.3, 11.1,
                 12.7, 14.3, 15.9, 17.5, 19.1, 20.6, 22.2, 23.8, 25.4, 27,
                 28.6, 31.8],
         60.3: [2.1, 2.8, 3.2, 3.6, 3.9, 4.4, 4.8, 5.5, 6.4, 7.1, 11.1],
         355.6: [4.8, 5.2, 5.3, 5.6, 6.4, 7.1, 7.9, 8.7, 9.5, 10.3, 11.1, 11.9,
                 12.7, 14.3, 15.9, 17.5, 19.1, 20.6, 22.2, 23.8, 25.4, 27,
                 28.6, 31.8],
         508: [5.6, 6.4, 7.1, 7.9, 8.7, 9.5, 10.3, 11.1, 11.9, 12.7, 14.3,
               15.9, 17.5, 19.1, 20.6, 22.2, 23.8, 25.4, 27, 28.6, 30.2, 31.8,
               33.3, 34.9]}


def recommended_wall_thickness(D_o, req_wt):
    """Number [m], Number [m] -> Number [m]
    Returns recommended API 5L wall thickness based on pipe outside diameter
    and required wall thickness """

    # Convert inputs to mm for dictionary lookup
    D_o_mm = 1000*D_o
    req_wt_mm = 1000*req_wt

    try:
        # Construct list of wall thicknesses greater than that required
        acceptable_wt = [size for size in sizes[D_o_mm] if size >= req_wt_mm]

        # Return minimum acceptable wall thickness as recommended in [m]
        return 1e-3 * min(acceptable_wt)

    except KeyError:
        print("\nOutside Diameter not standard API 5L size")
        raise

    except ValueError:
        print("\nRequired wall thickness greater than available API 5L sizes")
        raise
