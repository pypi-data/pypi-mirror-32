
# (My estimated Actual Font Height) / (Font Size)
FONT_HEIGHT_RATIO = 0.7

SuperScript_FontSizeReduction = 3
Superscript_YoffsetRatio = 0.8
Subscript_FontSizeReduction = 4
Subscript_YoffsetRatio = 0.5
FontSizeEnlargementStep = 2
KeepFontSize = True

class fontname:
    Times_Roman           = "Times-Roman"
    Times_Bold            = "Times-Bold"
    Times_Italic          = "Times-Italic"
    Times_BoldItalic      = "Times-BoldItalic"
    Helvetica             = "Helvetica"
    Helvetica_Bold        = "Helvetica-Bold"
    Helvetica_Oblique     = "Helvetica-Oblique"
    Helvetica_BoldOblique = "Helvetica-BoldOblique"
    Courier               = "Courier"
    Courier_Bold          = "Courier-Bold"
    Courier_Oblique       = "Courier-Oblique"
    Courier_BoldOblique   = "Courier-BoldOblique"
    Symbol                = "Symbol"
    Symbol_ZapfDingbats   = "ZapfDingbats"

ShortFontName = {
    #These font names are used in defining font in the
    #pdf obj
    fontname.Helvetica             : "FH",
    fontname.Helvetica_Bold        : "FHB",
    fontname.Helvetica_Oblique     : "FHO" ,
    fontname.Helvetica_BoldOblique : "FHBO",
    fontname.Times_Roman           : "FT",
    fontname.Times_Italic          : "FTI",
    fontname.Times_Bold            : "FTB",
    fontname.Times_BoldItalic      : "FTBI",
    fontname.Symbol                : "FS",
    fontname.Symbol_ZapfDingbats   : "FSZ" ,
    fontname.Courier               : "FC" ,
    fontname.Courier_Bold          : "FCB" ,
    fontname.Courier_Oblique       : "FCO" ,
    fontname.Courier_BoldOblique   : "FCBO",
    }

class fontwidth:
    # The data for the font width of typical fonts
    # I got these values manually using Ghostscript
    # The value for the fontwidth with font size 10 are arranged in ASCII order

    # To get the value fontwidth for a particular ASCII character,
    # enter the ASCII value then minus 32

    Symbol_10_Width = (
                    2.49789,
                    3.32728,
                    7.12756,
                    4.99901,
                    5.48822,
                    8.32953,
                    7.77876,
                    4.38993,
                    3.32728,
                    3.32728,
                    4.99901,
                    5.48822,
                    2.49789,
                    5.48822,
                    2.49789,
                    2.77975,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    2.77975,
                    2.77975,
                    5.48822,
                    5.48822,
                    5.48822,
                    4.43853,
                    5.48822,
                    7.21828,
                    6.66751,
                    7.21828,
                    6.11998,
                    6.10702,
                    7.62973,
                    6.02927,
                    7.21828,
                    3.32728,
                    6.30789,
                    7.21828,
                    6.85866,
                    8.88677,
                    7.21828,
                    7.21828,
                    7.67833,
                    7.40942,
                    5.5595,
                    5.91912,
                    6.10702,
                    6.89754,
                    4.38993,
                    7.67833,
                    6.4472,
                    7.94723,
                    6.10702,
                    3.32728,
                    8.62759,
                    3.32728,
                    6.5768,
                    4.99901,
                    4.99901,
                    6.30789,
                    5.48822,
                    5.48822,
                    4.93746,
                    4.38993,
                    5.2096,
                    4.10807,
                    6.02927,
                    3.2884,
                    6.02927,
                    5.48822,
                    5.48822,
                    5.75713,
                    5.2096,
                    5.48822,
                    5.48822,
                    5.2096,
                    5.48822,
                    6.02927,
                    4.38993,
                    5.75713,
                    7.12756,
                    6.85866,
                    4.92774,
                    6.85866,
                    4.93746,
                    4.79814,
                    1.99896,
                    4.79814,
                    5.48822
                )#}}}

    Helvetica_10_Width = (
                    2.77975, # 32 Space
                    2.77975, # 33 !
                    3.54758, # 34 "
                    5.5595,
                    5.5595,
                    8.88677,
                    6.66751,
                    2.20954,
                    3.32728,
                    3.32728,
                    3.88776,
                    5.83812,
                    2.77975,
                    3.32728,
                    2.77975,
                    2.77975,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    2.77975,
                    2.77975,
                    5.83812,
                    5.83812,
                    5.83812,
                    5.5595,
                    10.1471,
                    6.66751,
                    6.66751,
                    7.21828,
                    7.21828,
                    6.66751,
                    6.10702,
                    7.77876,
                    7.21828,
                    2.77975,
                    4.99901,
                    6.66751,
                    5.5595,
                    8.32953,
                    7.21828,
                    7.77876,
                    6.66751,
                    7.77876,
                    7.21828,
                    6.66751,
                    6.10702,
                    7.21828,
                    6.66751,
                    9.43754,
                    6.66751,
                    6.66751,
                    6.10702,
                    2.77975,
                    2.77975,
                    2.77975,
                    4.68799,
                    5.5595,
                    2.21926,
                    5.5595,
                    5.5595,
                    4.99901,
                    5.5595,
                    5.5595,
                    2.77975,
                    5.5595,
                    5.5595,
                    2.21926,
                    2.21926,
                    4.99901,
                    2.21926,
                    8.32953,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    3.32728,
                    4.99901,
                    2.77975,
                    5.5595,
                    4.99901,
                    7.21828,
                    4.99901,
                    4.99901,
                    4.99901,
                    3.33699,
                    2.59832,
                    3.33699,
                    5.83812
                )

    HelveticaBold_10_Width = (
                    2.77975,
                    3.32728,
                    4.73983,
                    5.5595,
                    5.5595,
                    8.88677,
                    7.21828,
                    2.77975,
                    3.32728,
                    3.32728,
                    3.88776,
                    5.83812,
                    2.77975,
                    3.32728,
                    2.77975,
                    2.77975,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    3.32728,
                    3.32728,
                    5.83812,
                    5.83812,
                    5.83812,
                    6.10702,
                    9.74856,
                    7.21828,
                    7.21828,
                    7.21828,
                    7.21828,
                    6.66751,
                    6.10702,
                    7.77876,
                    7.21828,
                    2.77975,
                    5.5595,
                    7.21828,
                    6.10702,
                    8.32953,
                    7.21828,
                    7.77876,
                    6.66751,
                    7.77876,
                    7.21828,
                    6.66751,
                    6.10702,
                    7.21828,
                    6.66751,
                    9.43754,
                    6.66751,
                    6.66751,
                    6.10702,
                    3.32728,
                    2.77975,
                    3.32728,
                    5.83812,
                    5.5595,
                    2.77975,
                    5.5595,
                    6.10702,
                    5.5595,
                    6.10702,
                    5.5595,
                    3.32728,
                    6.10702,
                    6.10702,
                    2.77975,
                    2.77975,
                    5.5595,
                    2.77975,
                    8.88677,
                    6.10702,
                    6.10702,
                    6.10702,
                    6.10702,
                    3.88776,
                    5.5595,
                    3.32728,
                    6.10702,
                    5.5595,
                    7.77876,
                    5.5595,
                    5.5595,
                    4.99901,
                    3.88776,
                    2.79919,
                    3.88776,
                    5.83812,
                )

    HelveticaOblique_10_Width = (
                    2.77975,
                    2.77975,
                    3.54758,
                    5.5595,
                    5.5595,
                    8.88677,
                    6.66751,
                    2.21926,
                    3.32728,
                    3.32728,
                    3.88776,
                    5.83812,
                    2.77975,
                    3.32728,
                    2.77975,
                    2.77975,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    2.77975,
                    2.77975,
                    5.83812,
                    5.83812,
                    5.83812,
                    5.5595,
                    10.1471,
                    6.66751,
                    6.66751,
                    7.21828,
                    7.21828,
                    6.66751,
                    6.10702,
                    7.77876,
                    7.21828,
                    2.77975,
                    4.99901,
                    6.66751,
                    5.5595,
                    8.32953,
                    7.21828,
                    7.77876,
                    6.66751,
                    7.77876,
                    7.21828,
                    6.66751,
                    6.10702,
                    7.21828,
                    6.66751,
                    9.43754,
                    6.66751,
                    6.66751,
                    6.10702,
                    2.77975,
                    2.77975,
                    2.77975,
                    4.68799,
                    5.5595,
                    2.21926,
                    5.5595,
                    5.5595,
                    4.99901,
                    5.5595,
                    5.5595,
                    2.77975,
                    5.5595,
                    5.5595,
                    2.21926,
                    2.21926,
                    4.99901,
                    2.21926,
                    8.32953,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    3.32728,
                    4.99901,
                    2.77975,
                    5.5595,
                    4.99901,
                    7.21828,
                    4.99901,
                    4.99901,
                    4.99901,
                    3.33699,
                    2.59832,
                    3.33699,
                    5.83812,
                ) #}}}

    HelveticaBoldOblique_10_Width =(2.77975, #{{{
                    3.32728,
                    4.73983,
                    5.5595,
                    5.5595,
                    8.88677,
                    7.21828,
                    2.77975,
                    3.32728,
                    3.32728,
                    3.88776,
                    5.83812,
                    2.77975,
                    3.32728,
                    2.77975,
                    2.77975,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    5.5595,
                    3.32728,
                    3.32728,
                    5.83812,
                    5.83812,
                    5.83812,
                    6.10702,
                    9.74856,
                    7.21828,
                    7.21828,
                    7.21828,
                    7.21828,
                    6.66751,
                    6.10702,
                    7.77876,
                    7.21828,
                    2.77975,
                    5.5595,
                    7.21828,
                    6.10702,
                    8.32953,
                    7.21828,
                    7.77876,
                    6.66751,
                    7.77876,
                    7.21828,
                    6.66751,
                    6.10702,
                    7.21828,
                    6.66751,
                    9.43754,
                    6.66751,
                    6.66751,
                    6.10702,
                    3.32728,
                    2.77975,
                    3.32728,
                    5.83812,
                    5.5595,
                    2.77975,
                    5.5595,
                    6.10702,
                    5.5595,
                    6.10702,
                    5.5595,
                    3.32728,
                    6.10702,
                    6.10702,
                    2.77975,
                    2.77975,
                    5.5595,
                    2.77975,
                    8.88677,
                    6.10702,
                    6.10702,
                    6.10702,
                    6.10702,
                    3.88776,
                    5.5595,
                    3.32728,
                    6.10702,
                    5.5595,
                    7.77876,
                    5.5595,
                    5.5595,
                    4.99901,
                    3.88776,
                    2.79919,
                    3.88776,
                    5.83812
                )#}}}

    TimesRoman_10_Width =     (    2.49789, # 32 Space {{{
                    3.32728, # 33 !
                    4.07891, # 34 "
                    4.99901,
                    4.99901,
                    8.32953,
                    7.77876,
                    3.32728,
                    3.32728,
                    3.32728,
                    4.99901,
                    5.63725,
                    2.49789,
                    3.32728,
                    2.49789,
                    2.77975,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    2.77975,
                    2.77975,
                    5.63725,
                    5.63725,
                    5.63725,
                    4.43853,
                    9.20751,
                    7.21828,
                    6.66751,
                    6.66751,
                    7.21828,
                    6.10702,
                    5.5595,
                    7.21828,
                    7.21828,
                    3.32728,
                    3.88776,
                    7.21828,
                    6.10702,
                    8.88677,
                    7.21828,
                    7.21828,
                    5.5595,
                    7.21828,
                    6.66751,
                    5.5595,
                    6.10702,
                    7.21828,
                    7.21828,
                    9.43754,
                    7.21828,
                    7.21828,
                    6.10702,
                    3.32728,
                    2.77975,
                    3.32728,
                    4.68799,
                    4.99901,
                    3.32728,
                    4.43853,
                    4.99901,
                    4.43853,
                    4.99901,
                    4.43853,
                    3.32728,
                    4.99901,
                    4.99901,
                    2.77975,
                    2.77975,
                    4.99901,
                    2.77975,
                    7.77876,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    3.32728,
                    3.88776,
                    2.77975,
                    4.99901,
                    4.99901,
                    7.21828,
                    4.99901,
                    4.99901,
                    4.43853,
                    4.79814,
                    1.99896,
                    4.79814,
                    5.40723 #126 ~
                )#}}}

    TimesItalic_10_Width = (    2.49789, #32 Space {{{
                    3.32728,
                    4.19878,
                    4.99901,
                    4.99901,
                    8.32953,
                    7.77876,
                    3.32728,
                    3.32728,
                    3.32728,
                    4.99901,
                    6.74851,
                    2.49789,
                    3.32728,
                    2.49789,
                    2.77975,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    3.32728,
                    3.32728,
                    6.74851,
                    6.74851,
                    6.74851,
                    4.99901,
                    9.19779,
                    6.10702,
                    6.10702,
                    6.66751,
                    7.21828,
                    6.10702,
                    6.10702,
                    7.21828,
                    7.21828,
                    3.32728,
                    4.43853,
                    6.66751,
                    5.5595,
                    8.32953,
                    6.66751,
                    7.21828,
                    6.10702,
                    7.21828,
                    6.10702,
                    4.99901,
                    5.5595,
                    7.21828,
                    6.10702,
                    8.32953,
                    6.10702,
                    5.5595,
                    5.5595,
                    3.88776,
                    2.77975,
                    3.88776,
                    4.21822,
                    4.99901,
                    3.32728,
                    4.99901,
                    4.99901,
                    4.43853,
                    4.99901,
                    4.43853,
                    2.77975,
                    4.99901,
                    4.99901,
                    2.77975,
                    2.77975,
                    4.43853,
                    2.77975,
                    7.21828,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    3.88776,
                    3.88776,
                    2.77975,
                    4.99901,
                    4.43853,
                    6.66751,
                    4.43853,
                    4.43853,
                    3.88776,
                    3.99791,
                    2.74735,
                    3.99791,
                    5.40723
                )#}}}

    TimesBold_10_Width =    (    2.49789, #32 Space {{{
                    3.32728,
                    5.54978,
                    4.99901,
                    4.99901,
                    9.99802,
                    8.32953,
                    3.32728,
                    3.32728,
                    3.32728,
                    4.99901,
                    5.69881,
                    2.49789,
                    3.32728,
                    2.49789,
                    2.77975,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    3.32728,
                    3.32728,
                    5.69881,
                    5.69881,
                    5.69881,
                    4.99901,
                    9.29823,
                    7.21828,
                    6.66751,
                    7.21828,
                    7.21828,
                    6.66751,
                    6.10702,
                    7.77876,
                    7.77876,
                    3.88776,
                    4.99901,
                    7.77876,
                    6.66751,
                    9.43754,
                    7.21828,
                    7.77876,
                    6.10702,
                    7.77876,
                    7.21828,
                    5.5595,
                    6.66751,
                    7.21828,
                    7.21828,
                    9.99802,
                    7.21828,
                    7.21828,
                    6.66751,
                    3.32728,
                    2.77975,
                    3.32728,
                    5.80896,
                    4.99901,
                    3.32728,
                    4.99901,
                    5.5595,
                    4.43853,
                    5.5595,
                    4.43853,
                    3.32728,
                    4.99901,
                    5.5595,
                    2.77975,
                    3.32728,
                    5.5595,
                    2.77975,
                    8.32953,
                    5.5595,
                    4.99901,
                    5.5595,
                    5.5595,
                    4.43853,
                    3.88776,
                    3.32728,
                    5.5595,
                    4.99901,
                    7.21828,
                    4.99901,
                    4.99901,
                    4.43853,
                    3.9396,
                    2.19982,
                    3.9396,
                    5.19988
                )#}}}

    TimesBoldItalic_10_Width = (    2.49789, #{{{
                    3.88776,
                    5.54978,
                    4.99901,
                    4.99901,
                    8.32953,
                    7.77876,
                    3.32728,
                    3.32728,
                    3.32728,
                    4.99901,
                    5.69881,
                    2.49789,
                    3.32728,
                    2.49789,
                    2.77975,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    4.99901,
                    3.32728,
                    3.32728,
                    5.69881,
                    5.69881,
                    5.69881,
                    4.99901,
                    8.31981,
                    6.66751,
                    6.66751,
                    6.66751,
                    7.21828,
                    6.66751,
                    6.66751,
                    7.21828,
                    7.77876,
                    3.88776,
                    4.99901,
                    6.66751,
                    6.10702,
                    8.88677,
                    7.21828,
                    7.21828,
                    6.10702,
                    7.21828,
                    6.66751,
                    5.5595,
                    6.10702,
                    7.21828,
                    6.66751,
                    8.88677,
                    6.66751,
                    6.10702,
                    6.10702,
                    3.32728,
                    2.77975,
                    3.32728,
                    5.69881,
                    4.99901,
                    3.32728,
                    4.99901,
                    4.99901,
                    4.43853,
                    4.99901,
                    4.43853,
                    3.32728,
                    4.99901,
                    5.5595,
                    2.77975,
                    2.77975,
                    4.99901,
                    2.77975,
                    7.77876,
                    5.5595,
                    4.99901,
                    4.99901,
                    4.99901,
                    3.88776,
                    3.88776,
                    2.77975,
                    5.5595,
                    4.43853,
                    6.66751,
                    4.99901,
                    4.43853,
                    3.88776,
                    3.47955,
                    2.19982,
                    3.47955,
                    5.69881,
                )#}}}
def GetFontWidth(AsciiDecNumber, Font,  FontSize):
    # A simple built-in code to estimate
    #the the font width for a desired font size.
    # It returns the value calculated based on the font 10 data above.
    # double GetFontWidth ( string AsciiNumber,
    #string Fontname, string DesiredFontSize)
    Index = AsciiDecNumber - 32
    if (Font=="Times-Roman") | (Font=="TimesNewRomanPSMT"):
        Width_FontSize10 = fontwidth.TimesRoman_10_Width[Index]
    elif Font == "Times-Italic":
        Width_FontSize10 = fontwidth.TimesItalic_10_Width[Index]
    elif Font == "Times-Bold":
        Width_FontSize10 = fontwidth.TimesBold_10_Width[Index]
    elif Font == "Times-BoldItalic":
        Width_FontSize10 = fontwidth.TimesBoldItalic_10_Width[Index]
    elif Font == "Helvetica":
        Width_FontSize10 = fontwidth.Helvetica_10_Width[Index]
    elif Font == "Helvetica-Bold":
        Width_FontSize10 = fontwidth.HelveticaBold_10_Width[Index]
    elif Font == "Helvetica-Oblique":
        Width_FontSize10 = fontwidth.HelveticaOblique_10_Width[Index]
    elif Font == "Helvetica-BoldOblique":
        Width_FontSize10 = fontwidth.HelveticaBoldOblique_10_Width[Index]
    elif Font == "Symbol":
        Width_FontSize10 = fontwidth.Symbol_10_Width[Index]
    elif Font == "Courier": #Courier is a fized width font
        Width_FontSize10 = 5.99687
    else:
        Width_FontSize10 = fontwidth.Helvetica_10_Width[Index]
    return (1.0 * FontSize/10)*Width_FontSize10

def GetStringWidth(string, FontName, FontSize):
    N= len(string)
    w=0.0
    for i in range(N):
        AsciiNumber = ord(string[i])
        if (AsciiNumber > 31) & (AsciiNumber<127):
            w += GetFontWidth(AsciiNumber, FontName, FontSize)
        else:
            print("Can not get ascii value");
    return w

def ChangeSuperSub(fontsize, attrib):
    #{{{
    yoffset=0
    if attrib == "superscript":
        yoffset = fontsize * FONT_HEIGHT_RATIO * Superscript_YoffsetRatio
        fontsize = fontsize - SuperScript_FontSizeReduction
    elif attrib == "subscript":
        fontsize = fontsize - Subscript_FontSizeReduction
        yoffset = -1*fontsize * FONT_HEIGHT_RATIO * Subscript_YoffsetRatio
    else:
        yoffset = 0
    return [fontsize, yoffset]#}}}

def ChangeFontAttrib(font, attrib):
    #{{{
    if attrib == "Italic":
        if font == fontname.Helvetica:
            font=fontname.Helvetica_Oblique
        elif font == fontname.Helvetica_Bold:
            font = fontname.Helvetica_BoldOblique
        elif font == fontname.Times_Roman:
            font = fontname.Times_Italic
        elif font == fontname.Times_Bold:
            font = fontname.Times_BoldItalic

    elif attrib == "Bold":
        if font == fontname.Helvetica:
            font=fontname.Helvetica_Bold
        elif font == fontname.Times_Roman:
            font = fontname.Times_Bold
    return font#}}}

def ChangeFontSize(fontsize, attrib):
    #{{{
    if attrib == "large":
        fontsize +=  FontSizeEnlargementStep
    elif attrib == "Large":
        fontsize +=  2* FontSizeEnlargementStep
    elif attrib == "small":
        fontsize -=  FontSizeEnlargementStep
    elif attrib == "Small":
        fontsize -= 2*FontSizeEnlargementStep
    return fontsize#}}}

def GetShortFontName(fontname):
    return ShortFontName[fontname]
